USING PERIODIC COMMIT LOAD CSV WITH HEADERS FROM 'file:///%s/%s-%s.txt' AS line FIELDTERMINATOR '|'
MATCH (n1:Committee { CMTE_ID:line.CMTE_ID})
MATCH (n2:Candidate { CAND_ID:line.CAND_ID })
MERGE(n2)-[cc:CANDIDATE_COMMITTEE{LINKAGE_ID:toInteger(line.LINKAGE_ID)}]-(n1)
ON CREATE SET
cc.CAND_ID = line.CAND_ID,
cc.CAND_ELECTION_YR = line.CAND_ELECTION_YR,
cc.FEC_ELECTION_YR = line.FEC_ELECTION_YR,
cc.CMTE_ID = line.CMTE_ID,
cc.CMTE_TP = line.CMTE_TP,
cc.CMTE_DSGN = line.CMTE_DSGN,
cc.LINKAGE_ID = toInteger(line.LINKAGE_ID)